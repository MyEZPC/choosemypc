//for   testing purposes
var pcparts = {
    "cpu": [{
        "id": 1,
        "processor": "Intel Core i7-8700K",
        "socket": "LGA1151",
        "price" : 1450
    }, {
        "id": 2,
        "processor": "Intel Core i5-8600K",
        "socket": "LGA1151",
        "price" : 1015
    }, {
        "id": 3,
        "processor": "AMD Ryzen 7 2700X",
        "socket": "AM4",
        "price" : 1422
    }, {
        "id": 4,
        "processor": "AMD Ryzen 5 1600",
        "socket": "AM4",
        "price" : 776
    }, {
        "id": 5,
        "processor": "AMD Ryzen 3 2200G",
        "socket": "AM4",
        "price" : 428
    }, {
        "id": 6,
        "processor": "AMD Ryzen 5 2600X",
        "socket": "AM4",
        "price" : 909
    }, {
        "id": 7,
        "processor": "Intel Core i7-7700K",
        "socket": "LGA1151",
        "price" : 1375
    }, {
        "id": 8,
        "processor": "AMD Ryzen 5 2400G",
        "socket": "AM4",
        "price" : 685
    }, {
        "id": 9,
        "processor": "Intel Core i3-8100",
        "socket": "LGA1151",
        "price" : 435
    }, {
        "id": 10,
        "processor": "Intel Core i9-7900X",
        "socket": "LGA2066",
        "price" : 3699
    }, {
        "id": 11,
        "processor": "Intel Core i5-4670K",
        "socket": "LGA1151",
        "price" : 700
    }
    ],
    "mobo": [{
        "id": 1,
        "manufacturer": "Asus",
        "motherBoard": "Asus ROG STRIX Z370-E GAMING",
        "moboSize": "ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["2133", "2400", "2666", "2800", "3000", "3200", "3300", "3333", "3400", "3466", "3600", "3733", "3866", "4000"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "4",
        "socket": "LGA1151",
        "price" : 1300
    }, {
        "id": 2,
        "manufacturer": "Asus",
        "motherBoard": "Asus STRIX B350-F GAMING",
        "moboSize": "ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["2133", "2400", "2666", "2933", "3200"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "4",
        "socket": "AM4",
        "price" : 566
    }, {
        "id": 3,
        "manufacturer": "MSI",
        "motherBoard": "MSI B350M GAMING PRO",
        "moboSize": "ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["1866", "2133", "2400", "2666", "2933", "3200"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "2",
        "socket": "AM4",
        "price" : 399
    }, {
        "id": 4,
        "manufacturer": "Gigabyte",
        "motherBoard": "GIGABYTE GA-B250M-DS3H",
        "moboSize": "Micro ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["2133", "2400"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "4",
        "socket": "LGA1151",
        "price" : 459
    }, {
        "id": 5,
        "manufacturer": "MSI",
        "motherBoard": "MSI B350M PRO-VD PLUS",
        "moboSize": "Micro ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["1866", "2133", "2400", "2666", "2933", "3200"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "4",
        "socket": "LGA1151",
        "price" : 339
    }, {
        "id": 6,
        "manufacturer": "Asus",
        "motherBoard": "Asus ROG RAMPAGE VI EXTREME",
        "moboSize": "EATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["2133", "2400", "2666", "2800", "3000", "3200", "3300", "3333", "3600", "3733", "3866", "4000", "4133", "4200"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "8",
        "socket": "LGA2066",
        "price" : 2759
    }, {
        "id": 7,
        "manufacturer": "Gigabyte",
        "motherBoard": "Gigabyte GA-AB350N-Gaming WIFI (rev. 1.0)",
        "moboSize": "Mini ITX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["2133", "2400", "2933", "3200"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "2",
        "socket": "AM4",
        "price" : 499
    }, {
        "id": 8,
        "manufacturer": "ASRock",
        "motherBoard": "ASRock X470 Master SLI/AC",
        "moboSize": "ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["2133", "2400", "2633", "2933", "3200", "3466"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "4",
        "socket": "AM4",
        "price" : 659
    }, {
        "id": 9,
        "manufacturer": "MSI",
        "motherBoard": "MSI B350 TOMAHAWK",
        "moboSize": "ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["1866", "2133", "2400", "2666", "2933", "3200"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "4",
        "socket": "AM4",
        "price" : 610
    }, {
        "id": 10,
        "manufacturer": "MSI",
        "motherBoard": "MSI B250M PRO-VD",
        "moboSize": "Micro ATX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": ["2133", "2400"]
        },
        "ramPin": "288-pin DIMM",
        "maxRamSlots": "2",
        "socket": "LGA1151",
        "price" : 378
    }
    ],
    "memory": [{
        "id": 1,
        "manufacturer": "Corsair",
        "ram": "Corsair Vengeance LPX x2",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "3000"
        },
        "ramPin": "288-pin DIMM",
        "size": "2x8gb",
        "price" : 859
    }, {
        "id": 2,
        "manufacturer": "Corsair",
        "ram": "Corsair Vengeance LPX",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "2400"
        },
        "ramPin": "288-pin DIMM",
        "size": "1x8gb",
        "price" : 354
    }, {
        "id": 3,
        "manufacturer": "G.Skill",
        "ram": "G.Skill Ripjaws X Series",
        "ramSpec": {
            "type": "DDR3",
            "frequency": "1600"
        },
        "ramPin": "240-pin DIMM",
        "size": "2x8gb",
        "price" : 672
    }, {
        "id": 4,
        "manufacturer": "Kingston",
        "ram": "Kingston HyperX Fury Black",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "2133"
        },
        "ramPin": "288-pin DIMM",
        "size": "2x4gb",
        "price" : 450
    }, {
        "id": 5,
        "manufacturer": "Team",
        "ram": "Team Vulcan",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "2400"
        },
        "ramPin": "288-pin DIMM",
        "size": "2x8gb",
        "price" : 616
    }, {
        "id": 6,
        "manufacturer": "Crucial",
        "ram": "Crucial Ballistix Sport LT",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "2400"
        },
        "ramPin": "288-pin DIMM",
        "size": "2x4gb",
        "price" : 339
    }, {
        "id": 7,
        "manufacturer": "G.Skill",
        "ram": "G.Skill Aegis",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "3000"
        },
        "ramPin": "288-pin DIMM",
        "size": "1x8gb",
        "price" : 350
    }, {
        "id": 8,
        "manufacturer": "G.Skill",
        "ram": "G.Skill Ripjaws V Series",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "2800"
        },
        "ramPin": "288-pin DIMM",
        "size": "1x8gb",
        "price" : 359
    }, {
        "id": 9,
        "manufacturer": "G.Skill",
        "ram": "G.Skill Trident Z RGB",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "3200"
        },
        "ramPin": "288-pin DIMM",
        "size": "2x8gb",
        "price" : 795
    }, {
        "id": 10,
        "manufacturer": "Team",
        "ram": "Team Elite Plus",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "2400"
        },
        "ramPin": "288-pin DIMM",
        "size": "1x8gb",
        "price" : 275
    }, {
        "id": 11,
        "manufacturer": "Patriot",
        "ram": "Patriot Viper 4",
        "ramSpec": {
            "type": "DDR4",
            "frequency": "3000"
        },
        "ramPin": "288-pin DIMM",
        "size": "2x8gb",
        "price" : 799
    }
    ],
    "gpu": [{
        "id": 1,
        "manufacturer": "MSI",
        "videoCard": "MSI GeForce GTX 1060 6GT OCV1",
        "vRam": "6gb",
        "memoryType": "GDDR5",
        "coreClock": "1.61GHz",
        "price" : 1300
    }, {
        "id": 2,
        "manufacturer": "Gigabyte",
        "videoCard": "Gigabyte GV-N107TWF2-8GD",
        "vRam": "8gb",
        "memoryType": "GDDR5",
        "coreClock": "1.63GHz",
        "price" : 1999
    }, {
        "id": 3,
        "manufacturer": "Gigabyte",
        "videoCard": "GeForce GTX 1080 8GB WINDFORCE OC 8G Video Card",
        "vRam": "8gb",
        "memoryType": "GDDR5X",
        "coreClock": "1.66GHz",
        "price" : 2899
    }, {
        "id": 4,
        "manufacturer": "Asus",
        "videoCard": "Asus ROG-STRIX-RX580-O8G-GAMING",
        "vRam": "8gb",
        "memoryType": "GDDR5",
        "coreClock": "1.26GHz",
        "price" : 1899
    }, {
        "id": 5,
        "manufacturer": "EVGA",
        "videoCard": "GeForce GTX 970 4GB Superclocked ACX 2.0",
        "vRam": "4gb",
        "memoryType": "GDDR5",
        "coreClock": "1.17GHz",
        "price" : 1300
    }
    ],
    "storage": [{
        "id": 1,
        "manufacturer": "Western Digital",
        "drive": "Caviar Blue 1TB 3.5 7200RPM Internal Hard Drive",
        "type": "HDD",
        "interface": "SATA 6 Gb/s",
        "capacity": "1tb",
        "price" : 159
    }, {
        "id": 2,
        "manufacturer": "Seagate",
        "drive": "Barracuda 2TB 3.5 7200RPM Internal Hard Drive",
        "type": "HDD",
        "interface": "SATA 6 Gb/s",
        "capacity": "2tb",
        "price" : 240
    }, {
        "id": 3,
        "manufacturer": "Samsung",
        "drive": "850 EVO-Series 500GB 2.5 Solid State Drive",
        "type": "SSD",
        "interface": "SATA 6 Gb/s",
        "capacity": "500gb",
        "price" : 535
    }, {
        "id": 4,
        "manufacturer": "Samsung",
        "drive": "970 Evo 500GB M.2-2280 Solid State Drive",
        "type": "SSD",
        "interface": "M.2",
        "capacity": "500gb",
        "price" : 1515
    }
    ],
    "cpuCooler": [{
        "id": 1,
        "cooler": "Cooler Master Hyper 212 EVO",
        "waterCooled": "no",
        "supportedSocket": ["AM2", "AM2+", "AM3", "AM3+", "AM4", "FM1", "FM2", "FM2+", "LGA1150", "LGA1151", "LGA1155", "LGA1156", "LGA1366", "LGA1366", "LGA2011", "LGA2011-3", "LGA2066", "LGA775"],
        "minFanRPM": "600",
        "maxFanRPM": "2000",
        "price" : 112
    }, {
        "id": 2,
        "cooler": "Corsair H100i v2",
        "waterCooled": "yes",
        "supportedSocket": ["AM2", "AM2+", "AM3", "AM3+", "AM4", "FM1", "FM2", "FM2+", "LGA1150", "LGA1151", "LGA1155", "LGA1156", "LGA1366", "LGA2011", "LGA2011-3", "LGA2066"],
        "minFanRPM": "",
        "maxFanRPM": "2435",
        "price" : 479
    }, {
        "id": 3,
        "cooler": "NZXT Kraken X62 Rev 2",
        "waterCooled": "yes",
        "supportedSocket": ["AM2", "AM2+", "AM3", "AM3+", "AM4", "FM1", "FM2", "FM2+", "LGA1150", "LGA1151", "LGA1155", "LGA1156", "LGA1366", "LGA2011", "LGA2011-3", "LGA2066", "TR4"],
        "minFanRPM": "500",
        "maxFanRPM": "1800",
        "price" : 719
    }, {
        "id": 4,
        "cooler": "CRYORIG H7",
        "waterCooled": "no",
        "supportedSocket": ["AM2", "AM2+", "AM3", "AM3+", "AM4", "FM1", "FM2", "FM2+", "LGA1150", "LGA1151", "LGA1155", "LGA1156"],
        "minFanRPM": "330",
        "maxFanRPM": "1600",
        "price" : 199
    }
    ],
    "psu": [{
        "id": 1,
        "manufacturer": "EVGA",
        "powerSupply": "EVGA SuperNOVA 650",
        "wattage": "650W",
        "modular": "Full",
        "efficiency": "80+ Gold",
        "type": "ATX",
        "price" : 455
    }, {
        "id": 2,
        "manufacturer": "Corsair",
        "powerSupply": "Corsair CX550M",
        "wattage": "550W",
        "modular": "Semi",
        "efficiency": "80+ Bronze",
        "type": "ATX",
        "price" : 346
    }, {
        "id": 3,
        "manufacturer": "Corsair",
        "powerSupply": "Corsair HX1000i",
        "wattage": "1000W",
        "modular": "Full",
        "efficiency": "80+ Platinum",
        "type": "ATX",
        "price" : 797
    }, {
        "id": 4,
        "manufacturer": "Corsair",
        "powerSupply": "Corsair TX550M Gold",
        "wattage": "550W",
        "modular": "Semi",
        "efficiency": "80+ Gold",
        "type": "ATX",
        "price" : 339
    }
    ],
    "casing": [{
        "id": 1,
        "manufacturer": "NZXT",
        "case": "NZXT S340 (Black/Red)",
        "type": "ATX Mid Tower",
        "frontUSB3": "yes",
        "moboCompatibility": ["ATX", "Micro ATX", "Mini ITX"],
        "price" : 437
    }, {
        "id": 2,
        "manufacturer": "Cougar",
        "case": "Cougar MX330",
        "type": "ATX Mid Tower",
        "frontUSB3": "yes",
        "moboCompatibility": ["ATX", "Micro ATX", "Mini ITX"],
        "price" : 199
    }, {
        "id": 3,
        "manufacturer": "Phanteks",
        "case": "Phanteks Enthoo Pro M Tempered Glass (Black)",
        "type": "ATX Mid Tower",
        "frontUSB3": "yes",
        "moboCompatibility": ["ATX", "Micro ATX", "Mini ITX"],
        "price" : 419
    }, {
        "id": 4,
        "manufacturer": "Thermaltake",
        "case": "Thermaltake Core V21",
        "type": "MicroATX Mini Tower",
        "frontUSB3": "yes",
        "moboCompatibility": ["Micro ATX", "Mini ITX"],
        "price" : 283
    }, {
        "id": 5,
        "manufacturer": "Fractal Design",
        "case": "Fractal Design Define R6 Black TG",
        "type": "ATX Mid Tower",
        "frontUSB3": "yes",
        "moboCompatibility": ["ATX", "EATX", "Micro ATX", "Mini ITX"],
        "price" : 650
    }
    ]
};

var consolidateParts = [];
var cpuCurrentIndex, moboCurrentIndex, memoryCurrentIndex, gpuCurrentIndex, storageCurrentIndex, coolerCurrentIndex, psuCurrentIndex, caseCurrentIndex;
var generateBtn = document.getElementById("generatePc");
var displayCpu = document.getElementById("cpu");
var displayMobo = document.getElementById("motherboard");
var displayRam = document.getElementById("ram");
var displayGpu = document.getElementById("gpu");
var displayStorage = document.getElementById("storage");
var displayCooler = document.getElementById("cooler");
var displayPsu = document.getElementById("psu");
var displayCase = document.getElementById("case");
var displayTotal = document.getElementById("consolidatePrice");

var totalPrice= 0 ;

function pickCpu(pcparts) {
    for (var i = pcparts.cpu.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        cpuCurrentIndex = pcparts.cpu[randomValue];
        return cpuCurrentIndex;
    }
}

function pickMobo(pcparts) {
    var trueMobo = [];
    for (var i = pcparts.mobo.length - 1; i > -1; i--) {
        if (cpuCurrentIndex.socket === pcparts.mobo[i].socket) {
            trueMobo = trueMobo.concat(pcparts.mobo[i]);
        }
    }
    for (var i = trueMobo.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        var temp = trueMobo[i];
        trueMobo[i] = trueMobo[randomValue];
        trueMobo[randomValue] = temp;
        moboCurrentIndex = trueMobo[randomValue];
    }
    return moboCurrentIndex;
}

function pickRam(pcparts) {
    var trueMemory = [];

    for (var i = pcparts.memory.length - 1; i > -1; i--) {
        if (moboCurrentIndex.ramSpec.frequency.indexOf(pcparts.memory[i].ramSpec.frequency) != -1 && moboCurrentIndex.ramSpec.type === pcparts.memory[i].ramSpec.type && moboCurrentIndex.ramPin === pcparts.memory[i].ramPin) {
            trueMemory = trueMemory.concat(pcparts.memory[i]);
        }
    }

    for (var i = trueMemory.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        var temp = trueMemory[i];
        trueMemory[i] = trueMemory[randomValue];
        trueMemory[randomValue] = temp;
        memoryCurrentIndex = trueMemory[randomValue];
    }
    return memoryCurrentIndex;
}

function pickGpu(pcparts) {
    for (var i = pcparts.gpu.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        gpuCurrentIndex = pcparts.gpu[randomValue];
        return gpuCurrentIndex;
    }
}

function pickStorage(pcparts) {
    for (var i = pcparts.storage.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        storageCurrentIndex = pcparts.storage[randomValue];
        return storageCurrentIndex;
    }
}

function pickCooler(pcparts) {
    var trueCooler = [];

    for (var i = pcparts.cpuCooler.length - 1; i > -1; i--) {
        if (pcparts.cpuCooler[i].supportedSocket.indexOf(cpuCurrentIndex.socket) != -1) {
            trueCooler = trueCooler.concat(pcparts.cpuCooler[i]);
        }
    }

    for (var i = trueCooler.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        var temp = trueCooler[i];
        trueCooler[i] = trueCooler[randomValue];
        trueCooler[randomValue] = temp;
        coolerCurrentIndex = trueCooler[randomValue];
    }
    return coolerCurrentIndex;
}

function pickPsu(pcparts) {
    for (var i = pcparts.psu.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        psuCurrentIndex = pcparts.psu[randomValue];
        return psuCurrentIndex;
    }
}

function pickCase(pcparts) {
    var trueCase = [];

    for (var i = pcparts.casing.length - 1; i > -1; i--) {
        if (pcparts.casing[i].moboCompatibility.indexOf(moboCurrentIndex.moboSize) != -1) {
            trueCase = trueCase.concat(pcparts.casing[i]);
        }
    }

    for (var i = trueCase.length - 1; i > -1; i--) {
        var randomValue = Math.floor(Math.random() * (i + 1));
        var temp = trueCase[i];
        trueCase[i] = trueCase[randomValue];
        trueCase[randomValue] = temp;
        caseCurrentIndex = trueCase[randomValue];
    }
    return caseCurrentIndex;
}

function pickAllParts() {
    pickCpu(pcparts);
    pickMobo(pcparts);
    pickRam(pcparts);
    pickGpu(pcparts);
    pickStorage(pcparts);
    pickCooler(pcparts);
    pickPsu(pcparts);
    pickCase(pcparts);
}

function combineParts() {
    consolidateParts = consolidateParts.concat(cpuCurrentIndex, moboCurrentIndex, memoryCurrentIndex, gpuCurrentIndex, storageCurrentIndex, coolerCurrentIndex, psuCurrentIndex, caseCurrentIndex);
    return consolidateParts;
}

function displayPrice() {
    for(i = 0; i < consolidateParts.length; i++){
        totalPrice += consolidateParts[i].price;
    }
    return totalPrice;
}

function displayParts() {
    var i = 0;
    displayCpu.textContent = "Processor: " + consolidateParts[i].processor + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].processor);
    i++;
    displayMobo.textContent = "Motherboard: " + consolidateParts[i].motherBoard + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].motherBoard);
    i++;
    displayRam.textContent = "Memory: " + consolidateParts[i].ram + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].ram);
    i++;
    displayGpu.textContent = "Video Card: " + consolidateParts[i].videoCard + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].videoCard);
    i++;
    displayStorage.textContent = "Storage: " + consolidateParts[i].drive + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].drive);
    i++;
    displayCooler.textContent = "Cpu Cooler: " + consolidateParts[i].cooler + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].cooler);
    i++;
    displayPsu.textContent = "Power Supply: " + consolidateParts[i].powerSupply + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].powerSupply);
    i++;
    displayCase.textContent = "Casing: " + consolidateParts[i].case + " --> RM" + consolidateParts[i].price;
    console.log(consolidateParts[i].case);
    displayTotal.textContent = "Total build: RM" + totalPrice;
}

function pickByPrice(){
    var choosePrice = document.getElementById("choosePrice");
    choosePrice = parseInt(choosePrice.value,10);
    console.log("You have chosen " + choosePrice);
    pickAllParts();
    combineParts();
    displayPrice();
    console.log(totalPrice);
    var i = true;
    while (i){
        if (totalPrice > choosePrice){
            totalPrice = 0;
            consolidateParts = [];
            pickAllParts();
            combineParts();
            displayPrice();
            console.log(totalPrice);
        }else {
            break;
        }
    }
    displayParts();
}

generateBtn.addEventListener("click", function () {
    pickByPrice();
    totalPrice = 0;
    consolidateParts = [];
});


